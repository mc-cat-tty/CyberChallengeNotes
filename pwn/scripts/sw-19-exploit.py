from pwn import *

HOST, PORT = 'software-19.challs.olicyber.it', 13002
BIN = './sw-19'

exe = ELF(BIN)
p = process(BIN)

if args.REMOTE:
    p = connect(HOST, PORT)

p.sendlineafter(b'iniziare ...', b'a')

while True:
    l = p.recvuntil(b": ")
    print(l)
    if b'Congratulazioni' in l:
        print(p.recvline())
        break
    fun = l.split(b':')[0].split(b' ')[1]
    # print(fun)
    addr = exe.sym[fun]
    # print(addr)
    p.sendline(hex(addr).encode())

